___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Shoparize",
  "brand": {
    "id": "brand_dummy",
    "displayName": "Custom Template",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Hiermit kann die Datenerfassung von Shoparize in die Website eingebunden werden.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "partner_id",
    "displayName": "Shoparize Partner ID",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "notSetText": "Please provide your Shoparize Partner ID"
  },
  {
    "type": "SELECT",
    "name": "pagetype",
    "displayName": "Page Type",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "normal",
        "displayValue": "Normal Page"
      },
      {
        "value": "purchase",
        "displayValue": "Purchase Page"
      }
    ],
    "simpleValueType": true,
    "alwaysInSummary": true
  },
  {
    "type": "SELECT",
    "name": "ecomm_datalayer",
    "displayName": "ECommerce DataLayer",
    "macrosInSelect": true,
    "selectItems": [
      {
        "value": "default",
        "displayValue": "Default DataLayer"
      },
      {
        "value": "manual",
        "displayValue": "Manual Setup"
      }
    ],
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "Provide your ECommerce Object.\u003cbr /\u003e\u003cbr /\u003e\n\nUse \"Default DataLayer\" for using the Standard ECommerce DataLayer of the Google Tag Manager (\u003cpre\u003edataLayer.ecommerce\u003c/pre\u003e).\u003cbr /\u003e\u003cbr /\u003e\n\nOr use \"Manual Setup\" to select all fields by your own.\u003cbr /\u003e\u003cbr /\u003e\n\nIf you have an separate ECommerce Object, you can select it from your GTM Variables.\u003cbr /\u003e\nThe Object should have the following fields and format (example):\u003cbr /\u003e\n\u003cpre\u003e{\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;transaction_id: \"t123\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;value: 39.48,\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;tax: 6.31,\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;shipping: 4.99,\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;currency: \"EUR\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;items: [\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;{\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;item_id: \"p42_1234\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;item_name: \"Shoparize Shirt white\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;currency: \"EUR\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;price: 29.49,\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;quantity: 1\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;},\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;{\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;item_id: \"p43_11\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;item_name: \"Shoparize Basecap\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;currency: \"EUR\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;price: 9.99,\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;quantity: 1\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;}\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;]\u003cbr /\u003e\n}\u003cbr /\u003e\n\u003c/pre\u003e",
    "subParams": [
      {
        "type": "LABEL",
        "name": "spaceholder2",
        "displayName": ""
      },
      {
        "type": "GROUP",
        "name": "ecomm_fields",
        "displayName": "Manual Setup for ECommerce Object",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "TEXT",
            "name": "transaction_id",
            "displayName": "Transaction ID",
            "simpleValueType": true,
            "help": "The Order ID"
          },
          {
            "type": "TEXT",
            "name": "currency",
            "displayName": "Currency",
            "simpleValueType": true,
            "help": "The Currency Code (ISO 4217)\u003cbr /\u003e\nE.g.: EUR\u003cbr /\u003e\u003cbr /\u003e\nCurrency Code List: https://www.iso.org/iso-4217-currency-codes.html"
          },
          {
            "type": "TEXT",
            "name": "revenue",
            "displayName": "Revenue (Total Value)",
            "simpleValueType": true,
            "help": "The Total Value of the Order, e.g.: 29.49",
            "valueValidators": [
              {
                "type": "REGEX",
                "args": [
                  "\\d+(\\.\\d+)?"
                ],
                "errorMessage": "Provide a value in the format 29.49"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "tax",
            "displayName": "Tax",
            "simpleValueType": true,
            "help": "The Tax, e.g.: 4.71",
            "valueValidators": [
              {
                "type": "REGEX",
                "args": [
                  "\\d+(\\.\\d+)?"
                ],
                "errorMessage": "Provide a value in the format 29.49"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "shipping",
            "displayName": "Shipping Costs",
            "simpleValueType": true,
            "help": "The Shipping Costs, e.g.: 4.99",
            "valueValidators": [
              {
                "type": "REGEX",
                "args": [
                  "\\d+(\\.\\d+)?"
                ],
                "errorMessage": "Provide a value in the format 29.49"
              }
            ]
          },
          {
            "type": "SELECT",
            "name": "items",
            "displayName": "Item (Product) Array",
            "macrosInSelect": true,
            "selectItems": [
              {
                "value": "default",
                "displayValue": "Default (GTM ECommerce DataLayer)"
              },
              {
                "value": "datalayer",
                "displayValue": "DataLayer Field"
              }
            ],
            "simpleValueType": true,
            "help": "Or provide the item (product) array with an own Variable. It should have the following fields and format (example):\u003cbr /\u003e\n\u003cpre\u003e\n[\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;{\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;item_id: \"p42_1234\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;item_name: \"Shoparize Shirt white\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;currency: \"EUR\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;price: 29.49,\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;quantity: 1\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;},\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;{\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;item_id: \"p43_11\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;item_name: \"Shoparize Basecap\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;currency: \"EUR\",\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;price: 9.99,\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;quantity: 1\u003cbr /\u003e\n\u0026nbsp;\u0026nbsp;}\u003cbr /\u003e\n]\u003cbr /\u003e\n\u003c/pre\u003e"
          },
          {
            "type": "TEXT",
            "name": "item_field",
            "displayName": "DataLayer Field with Product Array",
            "simpleValueType": true,
            "enablingConditions": [
              {
                "paramName": "items",
                "paramValue": "datalayer",
                "type": "EQUALS"
              }
            ]
          }
        ],
        "enablingConditions": [
          {
            "paramName": "ecomm_datalayer",
            "paramValue": "manual",
            "type": "EQUALS"
          }
        ]
      }
    ],
    "enablingConditions": [
      {
        "paramName": "pagetype",
        "paramValue": "purchase",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "addtitional_settings",
    "displayName": "Additional Settings",
    "groupStyle": "ZIPPY_OPEN_ON_PARAM",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "debug",
        "checkboxText": "Activate Debug Messages",
        "simpleValueType": true
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Required Libraries
const log = require('logToConsole');
const inject = require('injectScript');
//const setInWindow = require('setInWindow');
const callInWindow = require('callInWindow');
const copyFromWindow = require('copyFromWindow');
const setInWindow = require('setInWindow');
const copyFromDataLayer = require('copyFromDataLayer');
const JSON = require('JSON');

// Configuration
const shoparize_url = 'https://partner-cdn.shoparize.com/js/shoparize.js';
const debug = typeof data.debug=='boolean' ? data.debug : false;
const partner_id = data.partner_id;
const pagetype = data.pagetype;

// Callback (Main) Function
const onSuccess = function() {

  // Get Shoparize API
  let srapi = callInWindow('SHOPARIZE_API');
  if (debug) log('info', 'Shoparize Script for '+partner_id+' injected', srapi);

  // Normal Pageview
  if (pagetype=='normal') {
    // Run Shoparize Init
    srapi.init(partner_id);
    if (debug) log('info', 'Shoparize Init sent');
  }

  // Purchase Pageview
  if (pagetype=='purchase') {
    // Get ECommerce DataLayer
    const ec_dl = data.ecomm_datalayer;
    let ec = null;
    // Default EC DataLayer (dataLayer.ecommerce)
    if (typeof ec_dl=='string' && ec_dl=='default') {
      const ectmp = copyFromDataLayer('ecommerce');
      if (typeof ectmp=='object' && ectmp) {
        ec = JSON.parse(JSON.stringify(ectmp));
      } else {
        if (debug) log('warn', 'Shoparize: ecommerce object not existing (or valid) as dataLayer.ecommerce: ', ectmp);
      }
      ec = copyFromDataLayer('ecommerce');
      if (typeof ec!='object' || !ec) {
        if (debug) log('warn', 'Shoparize: ecommerce object not existing (or valid) in dataLayer! ECommerce Object: ', JSON.parse(JSON.stringify(ec)));
        ec = null;
      }
    }
    // Manual ECommerce Object
    else if (typeof ec_dl=='string' && ec_dl=='manual') {
      let items = null;
      // Default Items Object (dataLayer.ecommerce.items)
      if (typeof data.items=='string' && data.items=='default') {
        const ectmp = copyFromDataLayer('ecommerce');
        if (typeof ectmp=='object' && ectmp && typeof ectmp.items=='object') {
          items = JSON.parse(JSON.stringify(ectmp.items));
        } else {
          if (debug) log('warn', 'Shoparize: ecommerce.items object not existing (or valid) in dataLayer! ECommerce Object: ', JSON.parse(JSON.stringify(ectmp)));
        }
      }
      // Other DataLayer Items Object
      else if (typeof data.items=='string' && data.items=='datalayer' && typeof data.item_field=='string' && data.item_field) {
        const itemstmp = copyFromDataLayer(data.item_field);
        if (typeof itemstmp=='object' && itemstmp) {
          items = JSON.parse(JSON.stringify(itemstmp));
        } else {
          if (debug) log('warn', 'Shoparize: ecommerce.items object not existing (or valid) in dataLayer! ECommerce Object: ', JSON.parse(JSON.stringify(itemstmp)));
        }
      }
      // Items Object from a GTM Variable
      else {
        const itemstmp = data.items;
        if (typeof itemstmp=='object' && itemstmp) {
          items = JSON.parse(JSON.stringify(itemstmp));
        } else {
          if (debug) log('warn', 'Shoparize: ecommerce.items object not existing (or valid) in given GTM variables! Given Variable Content: ', itemstmp);
        }
      }
      ec = {
        transaction_id: data.transaction_id,
        value: data.revenue,
        tax: data.tax,
        shipping: data.shipping,
        currency: data.currency,
        items: items
      };
    }
    // ECommerce Object from an GTM Variable
    else {
      const ectmp = data.ecomm_datalayer;
      if (typeof ectmp=='object' && ectmp) {
        ec = JSON.parse(JSON.stringify(ectmp));
      } else {
        if (debug) log('warn', 'Shoparize: ecommerce object not existing (or valid) in given GTM variables! Given Variable Content: ', ectmp);
      }
    }
    if (debug) log('info', 'Shoparize ECommerce Object imported', JSON.parse(JSON.stringify(ec)));
    // Get/Create Shoparize DataLayer
    let sdl = copyFromWindow('dataLayerShoparize');
    if (typeof sdl!='object' || typeof sdl.length!='number') {
      setInWindow('dataLayerShoparize', [], true);
      sdl = copyFromWindow('dataLayerShoparize');
    }
    // Push EC Object
    const ec_obj = {
      event: 'purchase',
      ecommerce: ec
    };
    sdl.push(ec_obj);
    setInWindow('dataLayerShoparize', sdl, true);
    if (debug) log('info', 'Shoparize ECommerce Object sent to Shoparize DataLayer', JSON.parse(JSON.stringify(sdl)));
    // Run Shoparize Init
    srapi.init(partner_id);
    if (debug) log('info', 'Shoparize Init sent');
  }

};

// Error Handling
const onFailure = function() {
  if (debug) log('error', 'Error by loading Shoparize Script');
};

// Inject Script
inject(shoparize_url, onSuccess, onFailure/*, shoparize_url*/);
if (debug) log('info', 'Shoparize Script required for Partner Shop '+partner_id);

// Call data.gtmOnSuccess when the tag is finished.
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://*.shoparize.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "SHOPARIZE_API"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayerShoparize"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedKeys",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

# Shoparize GTM Template

- Version 1.0
- Autor: Andi Petzoldt <andi@petzoldt.net>
- Last Update: 15.01.2025

## Description

This Template is for using the Shoparize (Tracking) API for an easier use of the Shoparize API.

## Repository

Find the Repository here:
https://github.com/Andiministrator/Shoparize

## Licence

Apache 2.0


